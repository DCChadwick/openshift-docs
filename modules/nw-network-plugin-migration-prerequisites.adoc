// Module included in the following assemblies:
//
// * networking/ovn_kubernetes_network_provider/migrate-from-openshift-sdn.adoc
// * networking/openshift_sdn/migrate-to-openshift-sdn.adoc

ifeval::["{context}" == "migrate-to-openshift-sdn"]
:sdn: OpenShift SDN
:previous-sdn: OVN-Kubernetes
:type: OpenShiftSDN
endif::[]
ifeval::["{context}" == "migrate-from-openshift-sdn"]
:sdn: OVN-Kubernetes
:previous-sdn: OpenShift SDN
:type: OVNKubernetes
endif::[]

Before you migrate an Openshift SDN network plugin to a OVNKubernetes plugin, ensure that your environment meets the following prerequisites.


A cluster installed on infrastructure configured that is capable of the OVN-Kubernetes network plugin.

The cluster is in a known good state, without any errors. All operators must be in a healthy state, nodes must be ready.
    
Ensure there are no IP conflicts for openshift cluster nodes in the network.

Take the etcd backup of your cluster.

Migration takes care of MTU, i.e MTU in SDN set to 1450, will set to 1400 in OVN.

On all cloud platforms, on-prem platforms after updating software, a security group rule must be in place to allow UDP packets on port 6081 for all nodes, for on-prem/baremetal platforms make sure UDP port 6081 must be opened in the firewall on priority.

Third party webhook may cause this migration to fail, in such case take a backup of webhook and deleting it temporarily helps.

OVN-Kubernetes, the default network provider in OpenShift Container Platform 4.14 and later versions, uses the following IP address ranges internally: 100.64.0.0/16, 169.254.169.0/29, 100.88.0.0/16, fd98::/64, fd69::/125, and the fd97::/64. If your cluster uses OVN-Kubernetes, do not include any IP address ranges in any other CIDR definitions in your cluster.

In case, where the NODEIP_HINT param is used to point the secondary interface IP for configuring the OCP control plane nodes or any machine config is used for achieving the same , then make sure that ovn interface must have a default gateway (until bug OCPBUGS-31591 is released) in order to work properly with OVNK plugin.

If there is no NODEIP_HINT configured, ovn will set up its bridge i.e br-ex on default interface.

When a cluster depends on static routes and/or routing policies in the host network so that pods can reach some destinations, one needs to set routingViaHost to true and ipForwarding to Global in gatewayConfig during migration (to offload routing decision to host kernel).